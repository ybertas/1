<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uçak Oyunu – Sürüklemeli Kontrol</title>
    <style>
        :root {
            --bg: #E0F7FA;
            --banner: #0288D1;
            --btn: #0288D1;
            --btnText: #FFF;
            --font: 'Open Sans', sans-serif;
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html, body { width: 100vw; height: 100vh; overflow: hidden; font-family: var(--font); background: var(--bg); }
        #container {
            width: 100%;
            height: 100%;
            margin: auto;
            display: flex;
            flex-direction: column;
        }
        #banner {
            padding: 2vh;
            background: var(--banner);
            color: white;
            text-align: center;
            font-size: 4vw;
            flex: none;
        }
        #game-area {
            position: relative;
            flex: 1;
            background: skyblue;
            overflow: hidden;
        }
        #score {
            position: absolute;
            top: 2vh; right: 2vw;
            background: rgba(255,255,255,0.8);
            padding: 1vh 2vh;
            border-radius: 1vh;
            font-size: 3vw;
            font-weight: bold;
            z-index: 10;
        }
        #hearts {
            position: absolute;
            top: 2vh; left: 2vw;
            display: flex;
            gap: 1vh;
            z-index: 10;
        }
        #hearts div {
            width: 3vw; height: 3vw;
            background: red;
            clip-path: polygon(50% 0%,61% 30%,98% 35%,68% 58%,79%91%,50%75%,21%91%,32%59%,2%35%,39%30%);
        }
        .modal-overlay {
            position: absolute; inset: 0;
            background: rgba(0,0,0,0.6);
            display: flex; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none;
            transition: opacity 0.3s;
            z-index: 100;
        }
        .modal-overlay.show {
            opacity: 1; pointer-events: auto;
        }
        .modal {
    background: white;
    border-radius: 2vh;
    padding: 2vh;
    text-align: center;
    width: 90%;
    max-width: 750px; /* Eskisi: 400px */
    font-size: 1.3vw; /* Eskisi: 2vw, yazı küçüldü */
}

        .modal button {
            margin-top: 2vh;
            padding: 1vh 2vh;
            font-size: 2vw;
            background: var(--btn);
            color: var(--btnText);
            border: none;
            border-radius: 1vh;
            cursor: pointer;
        }
        #plane {
            position: absolute;
            width: 12vw;
            max-width: 120px;
            left: 5vw;
            top: 40%;
            touch-action: none;
            cursor: grab;
            z-index: 10;
        }
        .cloud {
            position: absolute;
            font-size: 2vh;
            font-weight: bold;
            color: #333;
            background: url('https://images.freeimages.com/vhq/images/previews/4c5/nuage-cloud-133980.png') no-repeat center;
            background-size: cover;
            width: 120px; height: 90px;
            display: flex; align-items: center; justify-content: center;
            z-index: 5;
            transition: box-shadow 0.3s, background-color 0.3s;
        }
        .cloud.correct {
            background-color: #42e66caa !important;
            box-shadow: 0 0 32px 8px #42e66c88;
            color: #fff;
        }
        .cloud.incorrect {
            background-color: #e64c4caa !important;
            box-shadow: 0 0 32px 8px #e64c4c88;
            color: #fff;
        }
        .cloud.correct::after {
            content: "✔️";
            position: absolute;
            top: -1vh; right: -1vh;
            font-size: 2vh;
        }
        .cloud.incorrect::after {
            content: "✖️";
            position: absolute;
            top: -1vh; right: -1vh;
            font-size: 2vh;
        }
        .shake-strong {
            animation: shake 0.7s cubic-bezier(.36,.07,.19,.97) both;
        }
        @keyframes shake {
            10%, 90% { transform: translate3d(-5px, 0, 0); }
            20%, 80% { transform: translate3d(8px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-12px, 0, 0); }
            40%, 60% { transform: translate3d(12px, 0, 0); }
        }
        @media (max-width: 768px) {
            #banner {
                font-size: 6vw;
            }
            #score {
                font-size: 4vw;
            }
            #plane {
                width: 20vw;
            }
            .cloud {
                width: 80px;
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="banner">Çift Bulutları Topla!</div>
        <div id="game-area">
            <div id="score">Doğru: <span id="scoreCount">0</span></div>
            <div id="hearts"></div>
            <img id="plane" src="ucak.png" alt="Uçak">
        </div>
        <div id="modal-start" class="modal-overlay show">
            <div class="modal">
                <h2>Nasıl Oynanır?</h2>
<p>
    <strong>Oyun Amacı:</strong><br>
    Uçağı kontrol ederek ekranda  ilerleyen bulutlara çarpmak. Amaç, çift (2 ile tam bölünebilen) sayılı bulutları toplamaktır. Yani, <b>sadece çift numaralı bulutlara çarptığınızda puan kazanırsınız</b>.
</p>
<p>
    <strong>Oyun Kuralları:</strong>
    
        <li>Her doğru bulut (çift sayılı) 1 puan kazandırır ve bulut yeşil olur.</li>
        <li>Yanlış buluta (tek sayılı) çarparsanız bulut kırmızı olur ve ekran sallanır.</li>
        <li>En fazla 3 kez yanlış yapabilirsiniz. 3 hata yaptığınızda oyun biter.</li>
        <li>10 doğruya ulaşırsanız oyunu kazanırsınız.</li>        
    </ul>
</p>
<p>
    <strong>Uçağı Kontrol Etme:</strong><br>
    Uçağın üstüne bir kere <b>fare ile basılı tutarak veya parmağınızla dokunarak</b> yukarı-aşağı sürükleyebilirsiniz.<br>
</p>
<p>
    <strong>Puanlama:</strong><br>
    Her doğru bulut için 1 puan. Yanlış bulutta hakkınız azalır. Toplam 10 doğruya ilk ulaşan kazanır.
</p>
<p>
    <em>Bol şans! Hedefiniz: 10 doğru bulut toplamaktır.</em>
</p>
<button id="btn-start">Oyuna Başla</button>

            </div>
        </div>
        <div id="modal-win" class="modal-overlay"><div class="modal"><h2>Tebrikler!</h2><p>10 doğru yaptın!</p><button id="btn-restart-win">Yeniden Başla</button></div></div>
        <div id="modal-lose" class="modal-overlay"><div class="modal"><h2>Üzgünüm...</h2><p>3 yanlış yaptın.</p><button id="btn-restart-lose">Yeniden Başla</button></div></div>
    </div>
    <audio id="sound-correct" src="https://assets.mixkit.co/sfx/preview/mixkit-positive-game-tone-2587.mp3"></audio>
    <audio id="sound-wrong" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-2586.mp3"></audio>
    <script>
        let correct = 0;
        let wrong = 0;
        let game = false;
        let cloudInterval;
        const maxWrong = 3;
        const maxCorrect = 10;

        // Bulut bölge yönetimi için
        const REGION_COUNT = 3; // Kaç bölgeye böleceğiz
        let regionClouds = Array(REGION_COUNT).fill(null); // Her bölgede 1 bulut olabilir

        const plane = document.getElementById("plane");
        const area = document.getElementById("game-area");
        const scoreEl = document.getElementById("scoreCount");
        const heartsEl = document.getElementById("hearts");

        const mods = {
            start: document.getElementById("modal-start"),
            win: document.getElementById("modal-win"),
            lose: document.getElementById("modal-lose")
        };

        const sounds = {
            correct: document.getElementById("sound-correct"),
            wrong: document.getElementById("sound-wrong")
        };

        let dragging = false;
        let offsetY = 0;

        function updateStatus() {
            scoreEl.textContent = correct;
            heartsEl.innerHTML = '';
            for (let i = 0; i < maxWrong - wrong; i++) {
                heartsEl.appendChild(document.createElement('div'));
            }
        }

        function showModal(type) {
            Object.values(mods).forEach(m => m.classList.remove('show'));
            if (type) {
                mods[type].classList.add('show');
            }
        }

        function getRegionHeights() {
            // Oyun alanını bölgeye ayırmak için yükseklikleri bul
            const height = area.clientHeight;
            const regionHeight = height / REGION_COUNT;
            return Array.from({length: REGION_COUNT}, (_, i) => ({
                top: i * regionHeight,
                bottom: (i + 1) * regionHeight
            }));
        }

        function getEmptyRegions() {
            // Hangi bölgede bulut yok? O bölgelerin indeksini döndür
            const regions = [];
            for (let i = 0; i < REGION_COUNT; i++) {
                if (!regionClouds[i]) regions.push(i);
            }
            return regions;
        }

        function createCloud() {
            // Maksimumda 1 bulut her bölgeye
            const emptyRegions = getEmptyRegions();
            if (emptyRegions.length === 0) return; // Tüm bölgeler doluysa çık

            // Aynı anda toplam 6 bulut sınırı
            if (area.querySelectorAll('.cloud').length >= 6) return;

            // Rastgele boş bir bölge seç
            const regionIndex = emptyRegions[Math.floor(Math.random() * emptyRegions.length)];
            const regions = getRegionHeights();
            const region = regions[regionIndex];

            // Bulutun vertical pozisyonunu o bölge içinde biraz random ayarla
            const cloudHeight = 90;
            let top = region.top + Math.random() * (region.bottom - region.top - cloudHeight);

            const n = Math.floor(Math.random() * 50);
            const left = area.clientWidth + 50;
            const c = document.createElement('div');
            c.className = 'cloud';
            c.dataset.num = n;
            c.dataset.region = regionIndex;
            c.style.top = top + 'px';
            c.style.left = left + 'px';
            c.innerText = n;
            area.appendChild(c);

            // Bölgeyi işaretle
            regionClouds[regionIndex] = c;
        }

        function clearRegionCloud(c) {
            // Bulut bir bölgeden çıkınca işareti kaldır
            if (c && typeof c.dataset.region !== "undefined") {
                regionClouds[parseInt(c.dataset.region)] = null;
            }
        }

        function gameLoop() {
            area.querySelectorAll('.cloud').forEach(c => {
                c.style.left = (parseFloat(c.style.left) - 2) + 'px';
                if (parseFloat(c.style.left) + c.clientWidth < 0) {
                    clearRegionCloud(c);
                    c.remove();
                }
                if (!c.classList.contains('hit')) {
                    const pr = plane.getBoundingClientRect();
                    const cr = c.getBoundingClientRect();
                    // Çarpışma kontrolü
                    if (!(pr.right < cr.left || pr.left > cr.right || pr.bottom < cr.top || pr.top > cr.bottom)) {
                        c.classList.add('hit');
                        const num = parseInt(c.dataset.num);
                        if (num % 2 === 0) {
                            // DOĞRU BULUT
                            c.classList.add('correct');
                            sounds.correct.currentTime = 0; sounds.correct.play();
                            correct++;
                            updateStatus();
                            setTimeout(() => {
                                clearRegionCloud(c);
                                c.remove();
                            }, 500);
                            if (correct >= maxCorrect) {
                                game = false;
                                clearInterval(cloudInterval);
                                showModal('win');
                            }
                        } else {
                            // YANLIŞ BULUT: daha güçlü sallansın, bulut kırmızı olsun, sonra silinsin
                            c.classList.add('incorrect');
                            sounds.wrong.currentTime = 0; sounds.wrong.play();
                            wrong++;
                            updateStatus();
                            area.classList.add('shake-strong');
                            setTimeout(() => area.classList.remove('shake-strong'), 700);
                            setTimeout(() => {
                                clearRegionCloud(c);
                                c.remove();
                            }, 650);
                            if (wrong >= maxWrong) {
                                game = false;
                                clearInterval(cloudInterval);
                                showModal('lose');
                            }
                        }
                    }
                }
            });
            if (game) {
                requestAnimationFrame(gameLoop);
            }
        }

        function startGame() {
            correct = 0;
            wrong = 0;
            game = true;
            updateStatus();
            // Bulutları sil ve bölgeyi temizle
            area.querySelectorAll('.cloud').forEach(c => c.remove());
            regionClouds = Array(REGION_COUNT).fill(null);
            showModal();
            cloudInterval = setInterval(createCloud, 1200);
            requestAnimationFrame(gameLoop);
        }

        // Sürükleme kontrolleri (değişmedi)
        plane.addEventListener('mousedown', e => {
            if (game) {
                dragging = true;
                offsetY = e.clientY - plane.getBoundingClientRect().top;
                plane.style.cursor = 'grabbing';
            }
        });
        area.addEventListener('mousemove', e => {
            if (!dragging) return;
            const rect = area.getBoundingClientRect();
            let y = e.clientY - rect.top - offsetY;
            y = Math.max(0, Math.min(area.clientHeight - plane.clientHeight, y));
            plane.style.top = y + 'px';
        });
        window.addEventListener('mouseup', () => {
            dragging = false;
            plane.style.cursor = 'grab';
        });

        plane.addEventListener('touchstart', e => {
            if (game) {
                dragging = true;
                offsetY = e.touches[0].clientY - plane.getBoundingClientRect().top;
            }
        }, { passive: false });
        area.addEventListener('touchmove', e => {
            if (!dragging) return;
            e.preventDefault();
            const rect = area.getBoundingClientRect();
            let y = e.touches[0].clientY - rect.top - offsetY;
            y = Math.max(0, Math.min(area.clientHeight - plane.clientHeight, y));
            plane.style.top = y + 'px';
        }, { passive: false });
        window.addEventListener('touchend', () => {
            dragging = false;
        });

        // Buton olayları
        document.getElementById('btn-start').onclick = startGame;
        document.getElementById('btn-restart-win').onclick = startGame;
        document.getElementById('btn-restart-lose').onclick = startGame;
    </script>
</body>
</html>
